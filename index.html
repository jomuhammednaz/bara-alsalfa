<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ù„Ø¹Ø¨Ø© Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ©</title>

  <style>
    :root{
      --bgA:#070A12;
      --bgB:#0B1227;

      --glass: rgba(255,255,255,.06);
      --border: rgba(255,255,255,.12);

      --text: #F3F6FF;
      --muted: rgba(243,246,255,.72);

      --shadow: 0 18px 60px rgba(0,0,0,.45);

      --primaryA:#6D5EF7;
      --primaryB:#4AC6FF;
      --dangerA:#FF4D6D;
      --dangerB:#FF9AA2;

      --input: rgba(10, 14, 24, .55);
      --inputBorder: rgba(255,255,255,.14);
      --focus: rgba(74,198,255,.32);

      --chip: rgba(255,255,255,.08);
      --chipBorder: rgba(255,255,255,.12);
    }

    *{ box-sizing: border-box; }
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(109,94,247,.35), transparent 55%),
        radial-gradient(1000px 520px at 85% 25%, rgba(74,198,255,.28), transparent 55%),
        radial-gradient(900px 520px at 40% 100%, rgba(255,77,109,.14), transparent 55%),
        linear-gradient(180deg, var(--bgA), var(--bgB));
      display:flex;
      justify-content:center;
      padding: 26px 12px 50px;
    }

    .wrap{
      width:min(980px, 100%);
      position:relative;
    }

    .bg-blur{
      position:absolute;
      inset: -80px -40px auto -40px;
      height: 220px;
      filter: blur(50px);
      opacity: .55;
      pointer-events:none;
      background: linear-gradient(90deg, rgba(109,94,247,.35), rgba(74,198,255,.26), rgba(255,77,109,.18));
      border-radius: 999px;
    }

    .topbar{
      display:flex;
      flex-direction: row-reverse;
      align-items:center;
      justify-content:flex-end;
      gap: 10px;
      margin-bottom: 14px;
    }

    h1{
      margin:0;
      font-size: clamp(22px, 2.2vw, 30px);
      letter-spacing: .2px;
      display:flex;
      align-items:center;
      gap: 10px;
    }

    #revealWordBtn{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      background: linear-gradient(135deg, rgba(109,94,247,.35), rgba(74,198,255,.18));
      border:1px solid var(--border);
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      transition: transform .08s ease, filter .12s ease;
      font-size: 22px;
    }
    #revealWordBtn:hover{ filter: brightness(1.08); }
    #revealWordBtn:active{ transform: scale(.97); }

    .card{
      background: var(--glass);
      border:1px solid var(--border);
      border-radius: 22px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 18px;
    }

    .muted{
      color: var(--muted);
      font-size: 14px;
      line-height: 1.8;
      margin: 8px 0 0;
    }

    .row{
      display:flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: flex-start;
    }
    .col{
      flex: 1;
      min-width: 260px;
    }

    label{
      display:inline-block;
      font-size: 14px;
      color: rgba(243,246,255,.86);
      margin-bottom: 6px;
      text-align:right;
      width:100%;
    }

    input, select, button{
      font: inherit;
      color: var(--text);
      background: var(--input);
      border: 1px solid var(--inputBorder);
      border-radius: 16px;
      padding: 11px 12px;
      outline: none;
      transition: border-color .12s ease, box-shadow .12s ease, transform .06s ease, filter .12s ease;
    }
    input, select{ width:100%; }
    select{ cursor:pointer; }
    input::placeholder{ color: rgba(243,246,255,.45); }

    input:focus, select:focus{
      border-color: rgba(74,198,255,.55);
      box-shadow: 0 0 0 4px var(--focus);
    }

    button{
      cursor:pointer;
      background: linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.14);
    }
    button:hover{ filter: brightness(1.06); }
    button:active{ transform: scale(.99); }

    .btn-inline{
      width:auto;
      padding: 11px 14px;
      white-space: nowrap;
    }

    .primary{
      background: linear-gradient(135deg, rgba(109,94,247,.95), rgba(74,198,255,.78));
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 14px 30px rgba(109,94,247,.22);
    }
    .danger{
      background: linear-gradient(135deg, rgba(255,77,109,.95), rgba(255,154,162,.75));
      border-color: rgba(255,255,255,.16);
      box-shadow: 0 14px 30px rgba(255,77,109,.14);
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(243,246,255,.9);
      font-size: 13px;
    }

    .hr{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.16), transparent);
      margin: 14px 0;
    }

    .spacer{ height: 12px; }
    .hidden{ display:none !important; }
    .center{ text-align:center; }
    .big{ font-size: 22px; line-height: 1.75; }

    #secretWordBox{
      margin: 10px 0 18px;
      padding: 14px 14px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(34,197,94,.14), rgba(74,198,255,.10));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 40px rgba(0,0,0,.25);
      text-align:right;
    }

    .inner{
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding: 16px;
    }

    #playersList{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      padding: 9px 12px;
      border-radius: 999px;
      background: var(--chip);
      border:1px solid var(--chipBorder);
    }
    .pill .x{
      width: 30px;
      height: 30px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.12);
      cursor:pointer;
      user-select:none;
      transition: transform .06s ease, filter .12s ease;
    }
    .pill .x:hover{ filter: brightness(1.08); }
    .pill .x:active{ transform: scale(.98); }

    .vote-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .choice{
      padding: 14px 14px;
      border-radius: 18px;
      cursor:pointer;
      user-select:none;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      transition: transform .06s ease, filter .12s ease, border-color .12s ease;
      text-align:right;
    }
    .choice:hover{
      filter: brightness(1.06);
      border-color: rgba(74,198,255,.28);
    }
    .choice:active{ transform: scale(.99); }

    ul{ margin: 10px 0 0; padding: 0 18px; }
    li{ margin: 6px 0; color: rgba(243,246,255,.88); }

    .min-note{
      flex-basis: 100%;
      width: 100%;
      text-align: right;
      margin-top: 6px;
    }

    /* âœ… Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙƒØ´Ù Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„ØªØµÙˆÙŠØª */
    .vote-title{
      display:flex;
      align-items:center;
      gap:10px;
      justify-content:flex-end;
    }
    #spyRevealIcon{
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      transition: transform .06s ease, filter .12s ease;
      font-size: 18px;
    }
    #spyRevealIcon:hover{ filter: brightness(1.08); }
    #spyRevealIcon:active{ transform: scale(.98); }

    /* âœ… ØµÙ†Ø¯ÙˆÙ‚ ÙŠØ¸Ù‡Ø± Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· */
    #spyBox{
      margin-top: 10px;
      padding: 12px 14px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(255,77,109,.16), rgba(109,94,247,.10));
      border: 1px solid rgba(255,255,255,.14);
      text-align: right;
    }

    @media (max-width:520px){
      #revealWordBtn{ width: 42px; height: 42px; }
      .big{ font-size: 20px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="bg-blur"></div>

    <div class="topbar">
      <h1>Ù„Ø¹Ø¨Ø© Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ©</h1>
      <span id="revealWordBtn" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ„Ù…Ø©">ğŸ­</span>
    </div>

    <div id="secretWordBox" class="hidden big"></div>

    <!-- SETUP -->
    <section id="screen-setup" class="card">
      <h2 style="margin:0 0 8px; text-align:right;">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <p class="muted" style="text-align:right;">
        Ø§ÙƒØªØ¨ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†ØŒ Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…ØŒ Ø«Ù… Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©. Ø³ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø´Ø®Øµ ÙˆØ§Ø­Ø¯ â€œØ¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ©â€ ÙˆØ§Ù„ÙƒÙ„Ù…Ø© ØªØ¸Ù‡Ø± Ù„Ù„Ø¨Ø§Ù‚ÙŠ.
        Ø¨Ø¹Ø¯Ù‡Ø§ ÙŠØ¸Ù‡Ø± ØªØ±ØªÙŠØ¨ â€œÙ…ÙŠÙ† ÙŠØ³Ø£Ù„ Ù…ÙŠÙ†â€ØŒ Ø«Ù… Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù„ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ø¨Ø§Ø³Ù…Ù‡.
      </p>

      <div class="spacer"></div>

      <div class="row">
        <div class="col">
          <label>Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ù„Ø§Ø¹Ø¨</label>

          <div class="row" style="align-items:center;">
            <input id="playerName" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯" />
            <button class="btn-inline" id="addPlayerBtn">Ø¥Ø¶Ø§ÙØ©</button>

            <div class="muted min-note">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ 3 Ù„Ø§Ø¹Ø¨ÙŠÙ†.</div>
          </div>
        </div>

        <div class="col">
          <label>Ø§Ù„Ù‚Ø³Ù…</label>
          <select id="category">
            <option value="places">Ù‚Ø³Ù… Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ (Ø£Ù…Ø§ÙƒÙ† ÙƒØ«ÙŠØ±Ø©)</option>
            <option value="syrianCharacters">Ù„Ø¹Ø¨Ø© Ø§Ù„Ø´Ø®ØµÙŠØ§Øª Ø§Ù„Ø³ÙˆØ±ÙŠØ©</option>
            <option value="turkishSeries">Ù‚Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø§Ù„ØªØ±ÙƒÙŠØ©</option>
            <option value="syrianSeries">Ù‚Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©</option>
          </select>
        </div>
      </div>

      <div class="hr"></div>

      <div>
        <h3 style="margin:0; text-align:right;">Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ†</h3>
        <div id="playersList"></div>
      </div>

      <div class="hr"></div>

      <div class="row">
        <button class="primary btn-inline" id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        <button class="danger btn-inline" id="resetBtn">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
      </div>
    </section>

    <!-- REVEAL -->
    <section id="screen-reveal" class="card hidden">
      <div class="row" style="justify-content: space-between; align-items:center;">
        <h2 style="margin:0; text-align:right;">Ø¹Ø±Ø¶ Ø§Ù„Ø¯ÙˆØ±</h2>
        <span class="badge" id="progressReveal"></span>
      </div>

      <div class="spacer"></div>
      <div class="center big" id="revealTitle"></div>
      <div class="spacer"></div>

      <div class="inner">
        <div class="center">
          <div class="muted">Ù…Ø±Ù‘Ø± Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ÙƒØªÙˆØ¨ Ø§Ø³Ù…Ù‡ ÙÙˆÙ‚. Ø«Ù… Ø§Ø¶ØºØ· Ø²Ø± â€œØ¹Ø±Ø¶â€.</div>
          <div class="spacer"></div>
          <button class="primary btn-inline" id="showRoleBtn">Ø¹Ø±Ø¶</button>
          <div class="spacer"></div>
          <div id="roleBox" class="big hidden"></div>
          <div class="spacer"></div>
          <button class="btn-inline hidden" id="nextRevealBtn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>
      </div>
    </section>

    <!-- QUESTIONS -->
    <section id="screen-questions" class="card hidden">
      <h2 style="margin:0; text-align:right;">ğŸ—£ï¸ Ù…ÙŠÙ† ÙŠØ³Ø£Ù„ Ù…ÙŠÙ†ØŸ</h2>
      <p class="muted" style="text-align:right;">
        Ù‡Ø°Ø§ ØªØ±ØªÙŠØ¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ. Ø¨Ø¥Ù…ÙƒØ§Ù†ÙƒÙ… ØªÙƒØ±Ø§Ø± Ø¬ÙˆÙ„Ø© Ø«Ø§Ù†ÙŠØ© Ø¨Ù†ÙØ³ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø£Ùˆ Ø§Ø¶ØºØ· â€œØ¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨â€ Ù„ØªØºÙŠÙŠØ±Ù‡Ø§.
      </p>

      <div class="hr"></div>
      <div id="pairsBox"></div>

      <div class="hr"></div>
      <div class="row">
        <button class="btn-inline" id="reshuffleBtn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨</button>
        <button class="primary btn-inline" id="startVoteBtn">Ø¨Ø¯Ø¡ Ø§Ù„ØªØµÙˆÙŠØª</button>
      </div>
    </section>

    <!-- VOTING -->
    <section id="screen-vote" class="card hidden">
      <div class="row" style="justify-content: space-between; align-items:center;">
        <!-- âœ… Ù‡Ù†Ø§ Ø£Ø¶ÙÙ†Ø§ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø¬Ø§Ù†Ø¨ ÙƒÙ„Ù…Ø© Ø§Ù„ØªØµÙˆÙŠØª -->
        <div class="vote-title">
          <h2 style="margin:0; text-align:right;">Ø§Ù„ØªØµÙˆÙŠØª</h2>
          <span id="spyRevealIcon" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø³Ø§Ù„ÙØ©">ğŸ•µï¸</span>
        </div>

        <span class="badge" id="progressVote"></span>
      </div>

      <!-- âœ… ØµÙ†Ø¯ÙˆÙ‚ ÙŠØ¸Ù‡Ø± Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· -->
      <div id="spyBox" class="hidden"></div>

      <div class="spacer"></div>
      <div class="center big" id="votePrompt"></div>
      <div class="muted center">Ø§Ø®ØªØ± Ø´Ø®Øµ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· (Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØµÙˆÙŠØª Ù„Ù†ÙØ³Ùƒ).</div>

      <div id="voteChoices" class="vote-grid"></div>

      <div class="hr"></div>
      <div class="center">
        <div class="muted">Ø¢Ø®Ø± Ø§Ø®ØªÙŠØ§Ø±:</div>
        <div id="lastVote" class="big">â€”</div>
        <div class="spacer"></div>
        <button class="btn-inline hidden" id="nextVoterBtn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
      </div>
    </section>

    <!-- RESULTS -->
    <section id="screen-results" class="card hidden">
      <h2 style="margin:0; text-align:right;">âœ… Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
      <div class="spacer"></div>
      <div id="resultsBox"></div>
      <div class="hr"></div>
      <button class="primary btn-inline" id="playAgainBtn">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©</button>
    </section>

  </div>

<script>
/* ----------------------- DATA (WORDS) ----------------------- */
const data = {
  places: [
    "Ù…Ø·Ø§Ø±","Ù…Ø¯Ø±Ø³Ø©","Ø¬Ø§Ù…Ø¹Ø©","Ù…Ø´ÙÙ‰","ØµÙŠØ¯Ù„ÙŠØ©","Ø­Ø¯ÙŠÙ‚Ø©","Ø´Ø§Ø·Ø¦","Ù…Ù‚Ù‡Ù‰","Ù…Ø·Ø¹Ù…","ÙÙ†Ø¯Ù‚",
    "Ù…ÙˆÙ„","Ø³ÙˆÙ‚ Ø´Ø¹Ø¨ÙŠ","Ù…Ø­Ø·Ø© Ø¨Ø§Øµ","Ù…Ø­Ø·Ø© Ù…ØªØ±Ùˆ","ÙˆØ±Ø´Ø© Ø³ÙŠØ§Ø±Ø§Øª","Ù…ÙƒØªØ¨Ø©","Ø³ÙŠÙ†Ù…Ø§","Ù…Ø³Ø±Ø­",
    "Ù…Ù„Ø¹Ø¨","ØµØ§Ù„Ø© Ø±ÙŠØ§Ø¶Ø©","Ù…Ø±ÙƒØ² Ø´Ø±Ø·Ø©","Ù…Ø­ÙƒÙ…Ø©","Ø¨Ù„Ø¯ÙŠØ©","Ù…Ø®Ø¨Ø²","ÙØ±Ù†","Ù…Ø­Ù„ Ø­Ù„ÙˆÙŠØ§Øª",
    "ØµØ§Ù„ÙˆÙ† Ø­Ù„Ø§Ù‚Ø©","Ù…Ø­Ù„ Ù…Ù„Ø§Ø¨Ø³","Ù…Ø­Ù„ Ø£Ø­Ø°ÙŠØ©","Ø³ÙˆØ¨Ø±Ù…Ø§Ø±ÙƒØª","Ù…Ø²Ø±Ø¹Ø©","Ø±ÙŠÙ","ØºØ§Ø¨Ø©",
    "Ø¬Ø¨Ù„","Ù†Ù‡Ø±","Ø¨Ø­ÙŠØ±Ø©","Ø³Ø¯","Ù…ÙŠÙ†Ø§Ø¡","Ù‚ØµØ±","Ù…ØªØ­Ù","Ù…Ø¹Ø±Ø¶","ÙƒØ±Ø§Ø¬","Ø´Ø§Ø±Ø¹ Ø±Ø¦ÙŠØ³ÙŠ",
    "Ø­ÙŠ Ù‚Ø¯ÙŠÙ…","Ù‚Ù‡ÙˆØ© Ø´Ø¹Ø¨ÙŠØ©","ÙƒØ§ÙÙŠÙ‡","Ù…Ø³Ø¨Ø­","Ù…Ù†ØªØ¬Ø¹","Ù…Ø®ÙŠÙ…","Ù…Ø¯Ø®Ù„ Ù…Ø¯ÙŠÙ†Ø©","Ø­Ø¯ÙˆØ¯",
    "Ù…ÙƒØªØ¨ Ø¹Ù‚Ø§Ø±Ø§Øª","Ø´Ø±ÙƒØ©","Ø¨Ù†Ùƒ","ATM","Ø¬Ø§Ù…Ø¹Ø© Ø®Ø§ØµØ©","Ù…Ø¯Ø±Ø³Ø© Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ","Ø±ÙˆØ¶Ø©","Ø³Ø§Ø­Ø©"
  ],
  syrianCharacters: [
    "Ù…Ø¹ØªØ²","Ø¹ØµØ§Ù…","Ø£Ø¨Ùˆ Ø´Ù‡Ø§Ø¨","Ø£Ø¨Ùˆ Ø¹ØµØ§Ù…","Ø§Ù„Ù†Ù…Ø³","Ø£Ø¨Ùˆ Ø¬ÙˆØ¯Øª","Ø³Ù…Ø¹Ùˆ","Ø¨Ùˆ Ø¨Ø¯Ø±",
    "ÙÙˆØ²ÙŠØ©","Ø£Ù… Ø¹ØµØ§Ù…","Ø£Ø¨Ùˆ Ø­Ø§ØªÙ…","Ø£Ø¨Ùˆ Ù…Ø­Ù…ÙˆØ¯","Ø£Ø¨Ùˆ ØºØ§Ù„Ø¨","Ø£Ø¨Ùˆ Ø§Ù„Ù†Ø§Ø±","Ø£Ø¨Ùˆ Ø·Ù„Ø§Ù„",
    "Ø£Ø¨Ùˆ ÙƒÙ„Ø¨Ø´Ø©","Ø´Ø§Ø¯ÙŠ","Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…","Ø®Ø§Ø·Ø±","Ø²Ù‡Ø±ÙŠØ©","Ø³Ù„ÙŠÙ…","Ø¬Ø§Ø¨Ø±","ÙˆØ¶Ø§Ø­","Ø±Ø§Ø²ÙŠ"
  ],
  turkishSeries: [
    "Ù‚ÙŠØ§Ù…Ø© Ø£Ø±Ø·ØºØ±Ù„","Ø§Ù„Ù…Ø¤Ø³Ø³ Ø¹Ø«Ù…Ø§Ù†","Ø§Ù„Ø­ÙØ±Ø©","Ø§Ù„Ø¹Ø´Ù‚ Ø§Ù„Ù…Ù…Ù†ÙˆØ¹","Ø·Ø§Ø¦Ø± Ø§Ù„Ø±ÙØ±Ø§Ù","Ø§Ø³Ù…Ø¹Ù†ÙŠ",
    "Ø­Ø¨ Ø£Ø¹Ù…Ù‰","ÙØ§Ø·Ù…Ø©","Ø¥ÙŠØ²ÙŠÙ„","Ø§Ù„Ø­Ø¨ Ù„Ø§ ÙŠÙÙ‡Ù… Ø§Ù„ÙƒÙ„Ø§Ù…","Ø²Ù‡Ø±Ø© Ø§Ù„Ø«Ø§Ù„ÙˆØ«",
    "Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©","Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø¹Ø¬Ø²Ø©","Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù…","Ø­Ø¨ Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±"
  ],
  syrianSeries: [
    "Ø¨Ø§Ø¨ Ø§Ù„Ø­Ø§Ø±Ø©","Ø¶ÙŠØ¹Ø© Ø¶Ø§ÙŠØ¹Ø©","Ø§Ù„Ø®Ø±Ø¨Ø©","ÙƒØ³Ø± Ø¹Ø¶Ù…","Ù†Ø¯Ù…","Ø§Ù„Ù‡ÙŠØ¨Ø©","Ø£Ù‡Ù„ Ø§Ù„ØºØ±Ø§Ù…",
    "Ø¹Ù†Ø§ÙŠØ© Ù…Ø´Ø¯Ø¯Ø©","ØµØ¨Ø§ÙŠØ§","Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø£Ø±Ø¨Ø¹Ø©","ØºØ²Ù„Ø§Ù† ÙÙŠ ØºØ§Ø¨Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨","Ø£ÙŠØ§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³Ø©",
    "Ø¨Ù‚Ø¹Ø© Ø¶ÙˆØ¡","ØªØ®Øª Ø´Ø±Ù‚ÙŠ","Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±","Ø²Ù…Ù† Ø§Ù„Ø¹Ø§Ø±","Ø±ÙˆØ²Ù†Ø§","ÙˆØ±Ø¯Ø© Ø´Ø§Ù…ÙŠØ©"
  ]
};

/* ----------------------- STATE ----------------------- */
let players = [];
let category = "places";
let secretWord = "";
let spyIndex = -1;

let revealIndex = 0;
let revealShown = false;

let questionOrder = [];
let voteIndex = 0;
let votes = {};
let votedBy = {};

/* ----------------------- HELPERS ----------------------- */
const $ = (id) => document.getElementById(id);

function showScreen(screenId){
  const screens = ["screen-setup","screen-reveal","screen-questions","screen-vote","screen-results"];
  screens.forEach(s => $(s).classList.add("hidden"));
  $(screenId).classList.remove("hidden");

  // âœ… Ø¥Ø°Ø§ Ø®Ø±Ø¬Ù†Ø§ Ù…Ù† Ø´Ø§Ø´Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù†Ø®ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¬Ø§Ø³ÙˆØ³
  if(screenId !== "screen-vote"){
    hideSpyBox();
  }
}

function escapeHtml(str){
  return str.replace(/[&<>"']/g, (m) => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}

function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1; i>0; i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function renderPlayers(){
  const box = $("playersList");
  box.innerHTML = "";
  if(players.length === 0){
    box.innerHTML = `<div class="muted" style="text-align:right;">Ù„Ù… ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø¹Ø¯.</div>`;
    return;
  }
  players.forEach((name, idx) => {
    const pill = document.createElement("div");
    pill.className = "pill";
    pill.innerHTML = `
      <span>${escapeHtml(name)}</span>
      <span class="x" title="Ø­Ø°Ù" onclick="removePlayer(${idx})">âœ–</span>
    `;
    box.appendChild(pill);
  });
}

window.removePlayer = function(idx){
  players.splice(idx,1);
  renderPlayers();
}

function hideSecretWordBox(){
  $("secretWordBox").classList.add("hidden");
  $("secretWordBox").textContent = "";
}

function pickSecret(){
  const words = data[category] || data.places;
  secretWord = words[Math.floor(Math.random()*words.length)];
  spyIndex = Math.floor(Math.random()*players.length);
  hideSecretWordBox();
  hideSpyBox();
}

/* ----------------------- ğŸ­ Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ„Ù…Ø© ----------------------- */
$("revealWordBtn").addEventListener("click", () => {
  if(!secretWord){
    alert("Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹ ğŸ˜„");
    return;
  }
  const box = $("secretWordBox");
  if(box.classList.contains("hidden")){
    box.textContent = "ğŸ”‘ Ø§Ù„ÙƒÙ„Ù…Ø© Ù‡ÙŠ: " + secretWord;
    box.classList.remove("hidden");
  } else {
    hideSecretWordBox();
  }
});

/* ----------------------- ğŸ•µï¸ Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø³Ø§Ù„ÙØ© ----------------------- */
function hideSpyBox(){
  const b = $("spyBox");
  b.classList.add("hidden");
  b.textContent = "";
}

$("spyRevealIcon").addEventListener("click", () => {
  if(spyIndex < 0 || !players.length){
    alert("Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹ ğŸ˜„");
    return;
  }
  const b = $("spyBox");
  if(b.classList.contains("hidden")){
    const spyName = players[spyIndex];
    b.innerHTML = `ğŸ•µï¸ <b>Ø®Ø§Ø±Ø¬ Ø§Ù„Ø³Ø§Ù„ÙØ© Ù‡Ùˆ:</b> ${escapeHtml(spyName)}`;
    b.classList.remove("hidden");
  } else {
    hideSpyBox();
  }
});

/* ----------------------- SETUP EVENTS ----------------------- */
$("addPlayerBtn").addEventListener("click", () => {
  const name = $("playerName").value.trim();
  if(!name) return;
  if(players.map(p => p.toLowerCase()).includes(name.toLowerCase())){
    alert("Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹.");
    return;
  }
  players.push(name);
  $("playerName").value = "";
  renderPlayers();
});

$("playerName").addEventListener("keydown", (e) => {
  if(e.key === "Enter") $("addPlayerBtn").click();
});

$("resetBtn").addEventListener("click", () => {
  players = [];
  secretWord = "";
  spyIndex = -1;
  hideSecretWordBox();
  hideSpyBox();
  renderPlayers();
  $("playerName").value = "";
});

$("startBtn").addEventListener("click", () => {
  category = $("category").value;
  if(players.length < 3){
    alert("Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† ÙÙŠ 3 Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.");
    return;
  }

  pickSecret();
  revealIndex = 0;
  revealShown = false;

  votes = {};
  votedBy = {};
  voteIndex = 0;

  questionOrder = shuffle([...players.keys()]);

  updateRevealUI();
  showScreen("screen-reveal");
});

/* ----------------------- REVEAL PHASE ----------------------- */
function updateRevealUI(){
  const name = players[revealIndex];
  $("revealTitle").innerHTML = `Ø§Ù„Ù„Ø§Ø¹Ø¨: <b>${escapeHtml(name)}</b>`;
  $("progressReveal").textContent = `${revealIndex+1} / ${players.length}`;

  $("roleBox").classList.add("hidden");
  $("roleBox").textContent = "";
  $("nextRevealBtn").classList.add("hidden");
  revealShown = false;
}

$("showRoleBtn").addEventListener("click", () => {
  if(revealShown) return;
  const isSpy = (revealIndex === spyIndex);
  const roleText = isSpy ? "ğŸ˜ˆ Ø£Ù†Øª Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ© (Ø§Ù„Ø¬Ø§Ø³ÙˆØ³)" : `âœ… Ø§Ù„ÙƒÙ„Ù…Ø© Ù‡ÙŠ: ${secretWord}`;
  $("roleBox").textContent = roleText;
  $("roleBox").classList.remove("hidden");
  $("nextRevealBtn").classList.remove("hidden");
  revealShown = true;
});

$("nextRevealBtn").addEventListener("click", () => {
  revealIndex++;
  if(revealIndex >= players.length){
    renderPairs();
    showScreen("screen-questions");
    return;
  }
  updateRevealUI();
});

/* ----------------------- QUESTION PAIRS ----------------------- */
function renderPairs(){
  const n = questionOrder.length;
  let html = `<div class="muted" style="text-align:right;">Ø§Ù„ØªØ±ØªÙŠØ¨:</div><ul>`;
  for(let i=0;i<n;i++){
    const asker = players[questionOrder[i]];
    const asked = players[questionOrder[(i+1)%n]];
    html += `<li><b>${escapeHtml(asker)}</b> ÙŠØ³Ø£Ù„ <b>${escapeHtml(asked)}</b></li>`;
  }
  html += `</ul>`;
  $("pairsBox").innerHTML = html;
}

$("reshuffleBtn").addEventListener("click", () => {
  questionOrder = shuffle(questionOrder);
  renderPairs();
});

$("startVoteBtn").addEventListener("click", () => {
  voteIndex = 0;
  updateVoteUI();
  showScreen("screen-vote");
});

/* ----------------------- VOTING PHASE ----------------------- */
function updateVoteUI(){
  const voter = players[voteIndex];
  $("progressVote").textContent = `${voteIndex+1} / ${players.length}`;
  $("votePrompt").innerHTML = `ğŸ‘¤ <b>${escapeHtml(voter)}</b> ØµÙˆÙ‘Øª Ø¹Ù„Ù‰ Ù…ÙŠÙ†ØŸ`;
  $("lastVote").textContent = votedBy[voter] ? `ØµÙˆÙ‘Øª Ø¹Ù„Ù‰: ${votedBy[voter]}` : "â€”";
  $("nextVoterBtn").classList.add("hidden");

  const choices = players.filter(p => p !== voter);
  const box = $("voteChoices");
  box.innerHTML = "";

  choices.forEach(target => {
    const div = document.createElement("div");
    div.className = "choice";
    div.innerHTML = `ØªØµÙˆÙŠØª Ù„Ù€ <b>${escapeHtml(target)}</b>`;
    div.addEventListener("click", () => castVote(voter, target));
    box.appendChild(div);
  });
}

function castVote(voter, target){
  if(votedBy[voter]){
    const prev = votedBy[voter];
    votes[prev] = (votes[prev] || 0) - 1;
  }
  votedBy[voter] = target;
  votes[target] = (votes[target] || 0) + 1;

  $("lastVote").textContent = `ØµÙˆÙ‘Øª Ø¹Ù„Ù‰: ${target}`;
  $("nextVoterBtn").classList.remove("hidden");
}

$("nextVoterBtn").addEventListener("click", () => {
  const voter = players[voteIndex];
  if(!votedBy[voter]){
    alert("Ù„Ø§Ø²Ù… ØªØ®ØªØ§Ø± Ø´Ø®Øµ Ù„Ù„ØªØµÙˆÙŠØª Ø£ÙˆÙ„Ø§Ù‹.");
    return;
  }

  voteIndex++;
  if(voteIndex >= players.length){
    renderResults();
    showScreen("screen-results");
    return;
  }
  updateVoteUI();
});

/* ----------------------- RESULTS ----------------------- */
function renderResults(){
  const sorted = players
    .map(name => ({ name, count: votes[name] || 0 }))
    .sort((a,b) => b.count - a.count);

  const spyName = players[spyIndex];

  let html = `
    <div class="inner">
      <div class="big" style="text-align:right;">ğŸ•µï¸ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø³Ø§Ù„ÙØ© ÙƒØ§Ù†: <b>${escapeHtml(spyName)}</b></div>
      <div class="big" style="text-align:right;">ğŸ”‘ Ø§Ù„ÙƒÙ„Ù…Ø© ÙƒØ§Ù†Øª: <b>${escapeHtml(secretWord)}</b></div>
    </div>
    <div class="spacer"></div>
    <h3 style="margin:0 0 6px; text-align:right;">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª</h3>
    <ul>
  `;

  sorted.forEach(r => {
    html += `<li><b>${escapeHtml(r.name)}</b>: ${r.count} ØµÙˆØª</li>`;
  });
  html += `</ul>`;

  const top = sorted[0];
  const topCount = top.count;
  const tied = sorted.filter(x => x.count === topCount).map(x => x.name);

  html += `<div class="hr"></div>`;
  if(topCount === 0){
    html += `<div class="big" style="text-align:right;">Ù…Ø§ ÙÙŠ Ø£ØµÙˆØ§Øª ğŸ¤·â€â™‚ï¸</div>`;
  } else if(tied.length > 1){
    html += `<div class="big" style="text-align:right;">ØªØ¹Ø§Ø¯Ù„ Ø¨ÙŠÙ†: <b>${escapeHtml(tied.join(" ØŒ "))}</b> Ø¨Ø¹Ø¯Ø¯ ${topCount} ØµÙˆØª</div>`;
  } else {
    html += `<div class="big" style="text-align:right;">Ø§Ù„Ø£ÙƒØ«Ø± Ø£ØµÙˆØ§ØªØ§Ù‹: <b>${escapeHtml(top.name)}</b> (${top.count})</div>`;
  }

  $("resultsBox").innerHTML = html;
}

$("playAgainBtn").addEventListener("click", () => {
  if(players.length < 3){
    showScreen("screen-setup");
    return;
  }
  pickSecret();
  revealIndex = 0;
  revealShown = false;

  votes = {};
  votedBy = {};
  voteIndex = 0;

  questionOrder = shuffle([...players.keys()]);
  updateRevealUI();
  showScreen("screen-reveal");
});

// initial render
renderPlayers();
</script>
</body>
</html>
